<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{NAME}} - Editor</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body class="base44-theme app-body">

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal-overlay hidden">
        <div class="modal-card">
            <div class="modal-header">
                <h3>Project Settings</h3>
                <button class="close-btn" onclick="toggleSettings()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Project Name</label>
                    <input type="text" id="setting-name" class="input-glass full-width">
                </div>
                <div class="form-group">
                    <label>Custom Instructions</label>
                    <textarea id="setting-instructions" class="input-glass full-width" rows="3"
                        placeholder="E.g., Always add comments to every action..."></textarea>
                </div>
                <div class="form-group">
                    <label>Visibility</label>
                    <div class="visibility-options">
                        <div class="vis-option selected" onclick="setProjectVisibility('public')">
                            <span class="vis-icon">üåç</span>
                            <div class="vis-text">
                                <strong>Public</strong>
                                <p>Anyone can view this shortcut.</p>
                            </div>
                        </div>
                        <div class="vis-option disabled" id="vis-private" onclick="setProjectVisibility('private')">
                            <span class="vis-icon">üîí</span>
                            <div class="vis-text">
                                <strong>Private</strong>
                                <p>Only you can view this.</p>
                            </div>
                            <div class="pro-badge">PRO</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="toggleSettings()">Cancel</button>
                <button class="btn-primary-sm" onclick="saveSettings()">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div id="export-modal" class="modal-overlay hidden">
        <div class="modal-card">
            <div class="modal-header">
                <h3>Export Shortcut</h3>
                <button class="close-btn" onclick="toggleExport()">√ó</button>
            </div>
            <div class="modal-body">
                <p style="color: var(--text-muted); margin-bottom: 1rem;">Choose how you want to save your shortcut.</p>
                <div class="export-options">
                    <div class="export-option" onclick="handleExport('download')">
                        <span class="export-icon">üíæ</span>
                        <span class="export-title">Download Only</span>
                        <span class="export-desc">Save .shortcut file privately.</span>
                    </div>
                    <div class="export-option" onclick="handleExport('publish')">
                        <span class="export-icon">üåç</span>
                        <span class="export-title">Publish & Download</span>
                        <span class="export-desc">Share with community.</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Layout -->
    <div class="app-layout">

        <!-- Collapsible Sidebar -->
        <aside class="app-sidebar" id="app-sidebar">
            <div class="sidebar-top">
                <div class="logo-container sm">
                    <div class="logo-icon sm">F</div>
                    <span class="logo-text">{{NAME}}</span>
                </div>
                <button class="collapse-btn" onclick="toggleSidebar()">¬´</button>
            </div>

            <div class="sidebar-projects">
                <div class="projects-header">
                    <span>PROJECTS</span>
                    <button class="add-project-btn" onclick="createNewProject()">+</button>
                </div>
                <div id="sidebar-project-list" class="project-list">
                    <!-- Injected by JS -->
                </div>
            </div>

            <div class="sidebar-bottom">
                <div class="user-profile">
                    <div class="avatar sm">üë§</div>
                    <div class="user-info">
                        <span class="user-name">User</span>
                        <span class="user-plan">Free Plan</span>
                    </div>
                    <button class="settings-btn" onclick="window.location.href='pricing.html'">‚öôÔ∏è</button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="app-main">

            <!-- Top Bar -->
            <header class="app-header">
                <div class="header-left">
                    <button class="mobile-menu-btn" onclick="toggleSidebar()">‚ò∞</button>
                    <div class="project-title-wrapper">
                        <input type="text" id="project-name-input" class="project-name-input" value="Untitled Project">
                    </div>
                </div>
                <div class="header-right">
                    <button class="icon-btn" onclick="toggleSettings()" title="Settings">‚öôÔ∏è</button>
                    <button class="btn-primary-sm" id="btn-export" onclick="toggleExport()">Export</button>
                </div>
            </header>

            <!-- Workspace -->
            <div class="workspace-container">

                <!-- Chat Panel -->
                <div class="panel chat-panel">
                    <div class="panel-header">
                        <h3>Assistant</h3>
                        <div class="model-selector-wrapper">
                            <select id="model-select" class="simple-select"
                                style="background: transparent; border: none; color: var(--text-muted); font-size: 0.85rem; outline: none;">
                                <!-- Injected by JS -->
                            </select>
                        </div>
                    </div>
                    <div class="chat-messages" id="messages">
                        <div class="message-row assistant">
                            <div class="avatar">‚ö°Ô∏è</div>
                            <div class="message-content">Hi! Describe the shortcut you want to build.</div>
                        </div>
                    </div>
                    <div class="chat-input-area">
                        <div id="active-constraints" class="constraints-container"></div>
                        <div class="chat-input-wrapper">
                            <button id="btn-add-action" class="add-action-btn" title="Add Context">+</button>
                            <textarea id="chat-input" placeholder="Type instructions..." rows="1"></textarea>
                            <button id="btn-send" class="send-btn">‚Üë</button>
                        </div>
                        <!-- Popovers -->
                        <div id="force-menu" class="force-menu hidden">
                            <div class="menu-item" onclick="showActionPicker()">‚ö°Ô∏è Force Action</div>
                        </div>
                        <div id="action-picker" class="picker-modal hidden">
                            <input type="text" id="action-search" placeholder="Search...">
                            <div class="action-list" id="action-list"></div>
                        </div>
                    </div>
                </div>

                <!-- Visualizer Panel -->
                <div class="panel visualizer-panel">
                    <div class="panel-header">
                        <h3>Preview</h3>
                        <div class="window-controls">
                            <span class="dot red"></span>
                            <span class="dot yellow"></span>
                            <span class="dot green"></span>
                        </div>
                    </div>
                    <div class="visualizer-content" id="visualizer-content">
                        <div class="empty-state">
                            <p>Actions will appear here.</p>
                        </div>
                    </div>
                    <div class="panel-footer">
                        <!-- Download button moved to Export Modal -->
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="theme.js"></script>
    <script src="script.js"></script>
</body>

</html>