<!DOCTYPE html>
<html lang="en">
<head>
  
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="CipherStick offers free browser-based OSINT challenges that test your ability to uncover digital clues‚Äîno account needed!" />
  <meta property="og:title" content="CipherStick - Free OSINT Puzzles">
  <meta property="og:description" content="CipherStick offers free browser-based OSINT challenges that test your ability to uncover digital clues‚Äîno account needed!" />
  <meta property="og:image" content="https://cipherstick.tech/ogimage.webp">
  <meta property="og:url" content="https://cipherstick.tech">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://cipherstick.tech/ogimage.webp">

  <title>CipherStick - Free OSINT Puzzles</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="style.css" />
  
<style>
  .ad-banner {
  a {
    color: rgb(58, 63, 71) !important;
  }
}
  
</style>
  <style>
    .new-badge {
  position: absolute;
  top: 10px;
  right: 10px;
  background: #00fff2;
  color: black;
  font-weight: bold;
  padding: 6px 12px;
  border-radius: 6px;
  font-family: 'Poppins', sans-serif;
  animation: pulse 2.5s infinite ease-in-out;
  box-shadow: 0 0 10px #005eff;
  z-index: 10;
}

@keyframes pulse {
  0% { transform: scale(1); box-shadow: 0 0 8px #001aff; }
  50% { transform: scale(1.15); box-shadow: 0 0 20px #0004ff; }
  100% { transform: scale(1); box-shadow: 0 0 8px #0800ff; }
}
  .challenge-stats-corner {
    position: absolute;
    bottom: 18px;
    right: 24px;
    background-color: #00074f;
    color: rgb(255, 255, 255);
    font-family: 'Courier New', monospace;
    font-size: 0.8rem;
    padding: 8px 14px;
    border: 1px solid #333;
    border-radius: 4px;
    text-align: right;
    z-index: 2;
    pointer-events: none;
    box-shadow: 0 0 10px rgba(0, 21, 255, 0.2);
    transform: scale(1.1);
  }

  .challenge-card {
    position: relative;
  }

  .challenge-stats-corner div {
    margin: 0;
    line-height: 1.3;
    text-transform: uppercase;
  }
  </style>
  <style>
  .scroll-down-bob {
    position: absolute;
    bottom: 30px;
    left: 50%;
    transform: translateX(-30%);
    font-family: 'Poppins', sans-serif;
    font-size: 1.2rem;
    color: #fff;
    animation: bobbing 2s infinite ease-in-out;
    text-shadow: 0 0 6px rgba(0,0,0,0.7);
    background: transparent;
    border: 2px solid #fff;
    padding: 10px 18px;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.3s, color 0.3s;
  }
  .scroll-down-bob:hover {
    background: rgba(255,255,255,0.1);
    color: #ffcccc;
  }
  @keyframes bobbing {
    0%, 100% { transform: translate(-50%, 0); }
    50% { transform: translate(-50%, -3px); }
  }
  </style>
  <link rel="canonical" href="https://cipherstick.tech/" />
  <script defer src="script.js"></script>

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "CipherStick - Free OSINT Puzzles",
    "description": "Train your OSINT skills with free browser-based challenges. Learn to trace digital clues like a pro.",
    "url": "https://cipherstick.tech",
    "image": "https://cipherstick.tech/ogimage.webp"
  }
  </script>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-M2NFQ1M6LR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-M2NFQ1M6LR');
</script>
<body>
  <p style="display:none;">Train your OSINT skills with free browser-based challenges that include automatic answer checking.</p>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê HEADER ‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <header class="site-header">
    <div class="container flex-between">
      <h1 class="logo-text">CipherStick</h1>

      <button id="navToggle" class="hamburger" aria-label="Menu">
        <span></span><span></span><span></span>
      </button>

      <nav id="siteNav">
        <ul>
          <li><a href="#about">About</a></li>
          <li><a href="#challenges">Challenges</a></li>
          <li><a href="#contact">Contact</a></li>
          <li><a href="https://www.buymeacoffee.com/midasthecoder" target="_blank" class="donate-link">Support Me</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê HERO IMAGE (78 vh) ‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <section class="hero image-hero"><h1 style="z-index: -1;">CipherStick ‚Äì Free OSINT Puzzles and Challenges</h1>
    <button class="scroll-down-bob" onclick="document.getElementById('challenges').scrollIntoView({ behavior: 'smooth' });">
      ‚Üì Play now - no account needed! ‚Üì
    </button>
  </section>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê WHAT IS OSINT ‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <section class="section alt-bg">
    <div class="container">
      <h2 class="section-title">What‚Äôs OSINT?</h2>
<p>
  OSINT‚Äîshort for <strong>Open Source Intelligence</strong>‚Äîis basically finding cool info from stuff anyone can access online. It‚Äôs like digital detective work, minus the trench coat. Journalists use it to check facts, security experts track threats with it, and curious folks use it to dig up surprising stories hiding in plain sight.
</p>
<p>
  All you need is your browser. You poke around websites, peek at metadata, chase down digital crumbs‚Äîand you don‚Äôt need to be a hacker. Just sharp eyes and some solid logic.
</p>
    </div>
  </section>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê ABOUT ‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <section id="about" class="section">
    <div class="container grid-two">
      <div>
        <h3>How It Works</h3>
<p>
  Each puzzle is just a single file that runs right in your browser. No accounts, no logins. Just open it, start exploring, and follow the clues‚Äîjust like a real OSINT pro would.
</p>
<p>
  It‚Äôs great for class demos, hacker workshops, or just leveling up your skills in private.
</p>
      </div>
      <div>
        <h3>Why Certificates Are Cool</h3>
<p>
  When you solve a puzzle, you get a PDF certificate on the spot‚Äîname, date, title, boom.
</p>
<p>
  This is great for anything - from bragging to a friend to framing on the wall!
</p>
      </div>
    </div>
  </section>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê CHALLENGES ‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <section id="challenges" class="section alt-bg">
    <div class="container">
      <h2 class="section-title">Choose&nbsp;Your&nbsp;Challenge</h2>
       
        <article class="challenge-card" id="card-fragment">
          <img src="FRAGMENT.webp" alt="Extreme banner">
          <div class="new-badge">NEW!</div>
          <div class="card-content">
            <h4><em>The Lazarus Fragment</em>&nbsp;&nbsp;<span style="color: #ffffff; font-weight: bold;">(Extreme)</span></h4>
            <p>The hardest CipherStick challenge yet.</p>
            <a href="
            OSINT-FRAGMENT.html"
            class="btn" target="_blank">
              Launch</a>
          </div>
          <div class="challenge-stats-corner">
            <div>Total Attempts: <span class="attempt-count">0</span></div>
            <div>Total Completions: <span class="completion-count">0</span></div>
          </div>
        </article>
        <br>
      <div class="card-wrapper">
        <article class="challenge-card" id="card-extreme">
          <img src="EXTREME.webp" alt="Extreme banner">
          <div class="card-content">
            <h4><em>The Fall of Enoch Hayes</em>&nbsp;&nbsp;<span style="color: #ffffff; font-weight: bold;">(Extreme)</span></h4>
            <p>The first advanced puzzle.</p>
            <a href="
            OSINT-EXTREME.html"
            class="btn" target="_blank">
              Launch</a>
          </div>
          <div class="challenge-stats-corner">
            <div>Total Attempts: <span class="attempt-count">0</span></div>
            <div>Total Completions: <span class="completion-count">0</span></div>
          </div>
        </article>
         <!-- Extreme (NEW) -->
           <article class="challenge-card" id="card-abyss">
  
          <img src="ABYSS.webp" alt="Abyss banner">
          <div class="card-content">
            <h4><em>The Abyss Protocol</em>&nbsp;&nbsp;<span style="color: #ffffff; font-weight: bold;">(Extreme)</span></h4>
            <p>Sequel to "The Fall of Enoch Hayes"</p>
            <a href="OSINT-ABYSS.html" class="btn" target="_blank">Launch</a>
          </div>
          <div class="challenge-stats-corner">
            <div>Total Attempts: <span class="attempt-count">0</span></div>
            <div>Total Completions: <span class="completion-count">0</span></div>
          </div>
        </article>
            <!-- Hard -->
        <article class="challenge-card" id="card-hard">
  <img src="HARD.webp" alt="Hard banner">
  <div class="card-content">
    <h4><em>The Digital Enigma</em>&nbsp;&nbsp;(Hard)</h4>
    <p>For intermediate players‚Äîclever clues and twists to keep you thinking.</p>
    <a href="OSINT-HARD.html" class="btn" target="_blank">Launch</a>
  </div>
  <div class="challenge-stats-corner">
    <div>Total Attempts: <span class="attempt-count">0</span></div>
    <div>Total Completions: <span class="completion-count">0</span></div>
  </div>
</article>
        <!-- Medium -->
       <article class="challenge-card" id="card-medium">
  <img src="OSINT_MEDIUM.webp" alt="Medium banner">
  <div class="card-content">
    <h4><em>The Vanishing Journalist</em>&nbsp;&nbsp;(Medium)</h4>
    <p>Great for beginners‚Äîlearn the basics of OSINT with a simple but engaging case.</p>
    <a href="OSINT-MEDIUM.html" class="btn" target="_blank">Launch</a>
  </div>
  <div class="challenge-stats-corner">
    <div>Total Attempts: <span class="attempt-count">0</span></div>
    <div>Total Completions: <span class="completion-count">0</span></div>
  </div>
</article>

    
      </div>
    </div>
  </section>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê DISCLAIMER (added) ‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <section class="section">
    <div class="container">
      <p style="max-width: 900px; margin: 1.5rem auto 0; color: #ccc; font-size: 0.95rem; text-align: center;">
        <strong>Disclaimer&nbsp;&mdash;&nbsp;</strong>All characters, organizations, and events featured in these puzzles are entirely fictional. They are crafted to <em>simulate</em> real-world OSINT investigations for educational purposes only.
      </p>
      <br>
      <p style="max-width: 900px; margin: 1.5rem auto 0; color: #ccc; font-size: 0.95rem; text-align: center;">
        An X/Twitter account will be needed to complete most puzzles.
      </p>
    </div>
  </section>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê EMAIL SIGNUP SECTION ‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <section class="section alt-bg" id="email">
    <div class="container">
      <h2 class="section-title">Want Updates When New Puzzles Drop?</h2>
      <p style="color: #ccc; max-width: 600px; margin: 0 auto 1.5rem; font-size: 1.1rem;">
        Enter your email and we'll let you know whenever a new CipherStick challenge goes live. No spam. Ever.
      </p>
      <form
        action="https://buttondown.com/api/emails/embed-subscribe/cipherstick"
        method="post"
        target="popupwindow"
        onsubmit="window.open('https://cipherstick.tech', 'popupwindow')"
        style="display: flex; flex-direction: column; gap: 1rem; align-items: center; max-width: 500px; margin: 0 auto;"
      >
        <input
          type="email"
          name="email"
          id="bd-email"
          required
          placeholder="you@example.com"
          style="padding: 14px; width: 100%; border: none; border-radius: 6px; font-size: 1rem;"
        />
        <input
          type="submit"
          class="btn"
          value="Notify Me"
          style="background-color: #ff0000; color: white; padding: 14px 28px; border: none; border-radius: 6px; font-size: 1rem; font-weight: bold; cursor: pointer; margin-top: 12px;"
        />
      </form>
    </div>
  </section>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê FAQ SECTION (replaces ad-banner) ‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <section class="section" id="faq">
    <div class="container">
      <h2 class="section-title">Frequently Asked Questions</h2>
      <div class="faq-item">
        <button class="faq-question">Is this really free?</button>
        <div class="faq-answer">
          <p>Yep! Every puzzle is 100% free to play‚Äîno account, no signup!</p>
        </div>
      </div>
      <div class="faq-item">
        <button class="faq-question">Do I need to install anything?</button>
        <div class="faq-answer">
          <p>Nope. Everything runs right in your browser. Just click and start the challenge.</p>
        </div>
      </div>
      <div class="faq-item">
        <button class="faq-question">Is this suitable for classrooms or workshops?</button>
        <div class="faq-answer">
          <p>Absolutely. It's perfect for OSINT demos, CTF warmups, and even homeschool use.</p>
        </div>
      </div>
      <div class="faq-item">
    <button class="faq-question">How can I support this?</button>
    <div class="faq-answer">
      <p>You can <a href="https://www.buymeacoffee.com/midasthecoder" target="_blank" style="color: #44aaff; font-weight: bold; text-decoration: underline;">buy me a coffee</a> or <a href="#" onclick="event.preventDefault(); navigator.share({ title: 'CipherStick', text: 'Train your OSINT skills with these free browser puzzles!', url: window.location.href });" style="color: #44aaff; font-weight: bold; text-decoration: underline;">share CipherStick</a> with a friend!</p>
    </div>
  </div>
  <button class="faq-question">How often do new puzzles come out?</button>
    <div class="faq-answer">
      <p>It depends! I like to aim for once a month, sometimes it takes longer. Follow us or check back often to catch the newest drops.</p>
    </div>
      <div class="faq-item">
  </div>
    </div>
  </section>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê CONTACT ‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <section id="contact" class="section">
    <div class="container contact-container">
      <h2 class="section-title">Questions, Comments or Suggestions? Contact Us.</h2>

      <form id="contactForm" class="contact-form" action="https://formspree.io/f/mvgabewp" method="POST">
        <div class="form-group">
          <label for="name">Name</label>
          <input id="name" type="text" name="name" required />
        </div>

        <div class="form-group">
          <label for="email">Email</label>
          <input id="email" type="email" name="email" required />
        </div>

        <div class="form-group">
          <label for="msg">Message</label>
          <textarea id="msg" name="message" rows="5" required></textarea>
        </div>

        <button type="submit" class="btn" style="border: red; cursor: pointer;">Send Message</button>
      </form>
    </div>
  </section>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê FOOTER ‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <footer class="site-footer">
    <div class="container flex-between">
      <p>¬© <span id="year"></span> CipherStick</p>
      <a rel="nofollow" href="https://x.com/cipherstick" aria-label="Twitter" target="_blank"><svg width="20" height="20" viewBox="0 0 20 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="cursor-pointer"><path class="fill-grey71 group-hover:fill-dark ease-in-out duration-100" d="M15.2719 0.586578H18.0831L11.9414 7.60616L19.1667 17.1582H13.5094L9.07837 11.3649L4.0083 17.1582H1.19537L7.76454 9.64999L0.833344 0.586578H6.63427L10.6395 5.88186L15.2719 0.586578ZM14.2853 15.4756H15.843L5.78784 2.18086H4.11623L14.2853 15.4756Z" fill="#717171"></path></svg></a>
      <p><a href="tos.html" target="_blank" style="color: #aaa; text-decoration: underline;">Terms of Service</a></p>
    </div>
  </footer>

  <!-- simple handler -->
  <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="midasthecoder" data-description="Support me on Buy me a coffee!" data-message="" data-color="white" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

  <script>
    // Set current year in footer
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
  <script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.9.0/firebase-auth.js";
import { getDatabase, ref, onValue, push } from "https://www.gstatic.com/firebasejs/11.9.0/firebase-database.js";

try {
  const firebaseConfig = {
    apiKey: "AIzaSyAiqYse2jzA7l2r6VkwdmdBGs0LzwkXb2Y",
    authDomain: "cipherstick.firebaseapp.com",
    databaseURL: "https://cipherstick-default-rtdb.firebaseio.com/",
    projectId: "cipherstick",
    storageBucket: "cipherstick.firebasestorage.app",
    messagingSenderId: "827207706323",
    appId: "1:827207706323:web:a84d3c536b25e0e66c5626"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  console.log("‚úÖ Firebase initialized in index.html");

  // (consentEl and fetchFingerprint removed)

  function setupStats(cardId, difficulty) {
    const completionsRef = ref(db, `completions/${difficulty}`);
    const attemptsRef = ref(db, `attempts/${difficulty}`);

    const card = document.getElementById(cardId);
    const completionEl = card.querySelector('.completion-count');
    const attemptEl = card.querySelector('.attempt-count');

    onValue(completionsRef, (snap) => {
      const data = snap.val();
      const count = data ? Object.keys(data).length : 0;
      console.log(`‚úÖ Completions (${difficulty}): ${count}`);
      completionEl.textContent = count;
    }, (error) => {
      console.error(`‚ùå Failed to fetch completions for ${difficulty}:`, error);
    });

    onValue(attemptsRef, (snap) => {
      const data = snap.val();
      const count = data ? Object.keys(data).length : 0;
      console.log(`‚úÖ Attempts (${difficulty}): ${count}`);
      attemptEl.textContent = count;
    }, (error) => {
      console.error(`‚ùå Failed to fetch attempts for ${difficulty}:`, error);
    });
  }

  setupStats("card-extreme", "extreme");
  setupStats("card-fragment", "FRAGMENT");
  setupStats("card-abyss", "abyss");
  setupStats("card-medium", "medium");
  setupStats("card-hard", "hard");

  // ===== Review Modal Logic =====
  const overlay = document.getElementById('reviewOverlay');
  const closeBtn = document.getElementById('reviewCloseBtn');
  const form = document.getElementById('reviewForm');
  const submitBtn = document.getElementById('reviewSubmitBtn');
  const toast = document.getElementById('reviewToast');
  const nameEl = document.getElementById('reviewName');
  const textEl = document.getElementById('reviewText');
  const charCount = document.getElementById('charCount');
  const charMsg = document.getElementById('charMsg');

  const MIN_CHARS = 50;
  const MAX_CHARS = 250;

  function sanitize(str){
    return String(str).replace(/[\u0000-\u001F\u007F]/g,'').trim();
  }

  function showToast(msg, ok=true){
    toast.textContent = msg;
    toast.style.display = 'block';
    toast.style.borderColor = ok ? '#1e2432' : '#8b2c2c';
    clearTimeout(window.__review_t);
    window.__review_t = setTimeout(()=>{ toast.style.display='none'; }, 3000);
  }

  function openReview(){
    if(!overlay) return;
    overlay.style.display = 'flex';
    // keep page scroll enabled
  }
  function stripReviewParam(){
    try{
      const url = new URL(window.location.href);
      if(url.searchParams.has('review')){
        url.searchParams.delete('review');
        const qs = url.searchParams.toString();
        const next = url.pathname + (qs ? `?${qs}` : '') + url.hash;
        history.replaceState({}, '', next);
      }
    }catch(_e){}
  }
  function closeReview(){
    if(!overlay) return;
    overlay.style.display = 'none';
    stripReviewParam();
  }

  // Star painting
  (function(){
    const labels = Array.from(document.querySelectorAll('#reviewForm [data-star]'));
    function paint(n){
      labels.forEach(l => {
        const val = Number(l.getAttribute('data-star'));
        l.style.background = (val <= n) ? '#172036' : 'transparent';
        l.style.borderColor = (val <= n) ? '#2f3a53' : '#232a3a';
        l.style.color = (val <= n) ? '#ffd166' : '#9aa7bd';
      });
    }
    labels.forEach(l => {
      l.addEventListener('click', ()=>{
        const n = Number(l.getAttribute('data-star'));
        const input = document.getElementById('reviewStar'+n);
        if(input) input.checked = true;
        paint(n);
        validateForm();
      });
    });
    const checked = document.querySelector('input[name="reviewStars"]:checked');
    if(checked) paint(Number(checked.value));
  })();

  function updateCounter(){
    const len = sanitize(textEl.value).length;
    charCount.textContent = `${len}/${MAX_CHARS}`;
    const okMin = len >= MIN_CHARS;
    const okMax = len <= MAX_CHARS;
    textEl.style.borderColor = (okMin && okMax) ? '#2f3a53' : '#8b2c2c';
    charMsg.textContent = okMin ? (okMax ? 'Looks good.' : 'Too long ‚Äì trim it to 250.') : 'Please write some more.';
    validateForm();
  }

  function validateForm(){
    const authReady = !!window.__review_uid;
    const nameOk = !!sanitize(nameEl.value);
    const starsChecked = !!document.querySelector('input[name="reviewStars"]:checked');
    const len = sanitize(textEl.value).length;
    const textOk = (len >= MIN_CHARS && len <= MAX_CHARS);
    submitBtn.disabled = !(authReady && nameOk && starsChecked && textOk);
  }
  if(textEl) textEl.addEventListener('input', updateCounter);
  if(nameEl) nameEl.addEventListener('input', validateForm);
  Array.from(document.querySelectorAll('input[name="reviewStars"]')).forEach(el=>{
    el.addEventListener('change', validateForm);
  });

  if(closeBtn){
    closeBtn.addEventListener('click', closeReview);
  }
  if(overlay){
    overlay.addEventListener('click', (e)=>{ if(e.target === overlay) closeReview(); });
  }
  window.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeReview(); });

  // Open if ?review is present
  try {
    const params = new URLSearchParams(window.location.search);
    if(params.has('review')) openReview();
  } catch(_e) {}

  // Firebase Auth (anonymous) using the same app
  const auth = getAuth(app);
  onAuthStateChanged(auth, (user)=>{
    if(user){
      window.__review_uid = user.uid;
      validateForm();
    } else {
      submitBtn.disabled = true;
    }
  });
  signInAnonymously(auth).catch(err=>{
    console.warn('Auth error:', err);
    showToast('Auth failed. Try reloading.', false);
  });

  // Submit handler -> Realtime DB /reviews
  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    if(!window.__review_uid){ showToast('Not connected yet. One sec‚Ä¶', false); return; }

    const name = sanitize(nameEl.value).slice(0,80);
    const text = sanitize(textEl.value).slice(0,250);
    const starsInput = document.querySelector('input[name="reviewStars"]:checked');
    const stars = starsInput ? Number(starsInput.value) : 0;

    if(!name || !text || !stars){ showToast('Please provide name, rating, and review text.', false); return; }
    if(text.length < MIN_CHARS || text.length > MAX_CHARS){ showToast(`Review must be ${MIN_CHARS}-${MAX_CHARS} characters.`, false); return; }

    // Device ID + UA-CH model helper
    async function sha256Hex(str) {
      const enc = new TextEncoder().encode(str);
      const buf = await crypto.subtle.digest('SHA-256', enc);
      return [...new Uint8Array(buf)].map(b => b.toString(16).padStart(2, '0')).join('');
    }
    async function getUaChModel() {
      try {
        if (navigator.userAgentData?.getHighEntropyValues) {
          const { model } = await navigator.userAgentData.getHighEntropyValues(['model']);
          return model || null;
        }
      } catch(_) {}
      return null;
    }
    const ua = navigator.userAgent || '';
    const platform = navigator.platform || '';
    const vendor = navigator.vendor || '';
    const model = await getUaChModel();
    const deviceId = await sha256Hex([ua, platform, vendor, model || ''].join('|'));

    const payload = {
      name,
      stars,
      text,
      uid: window.__review_uid,
      timestamp: Date.now(),
      device: {
        id: deviceId,
        ua: ua,
        platform,
        vendor,
        model
      }
    };

    try {
      await push(ref(db, 'reviews'), payload);
      showToast('Thanks! Your review was submitted.');
      form.reset();
      updateCounter();
      validateForm();
      setTimeout(closeReview, 350);
    } catch(err){
      console.error('DB write failed:', err);
      showToast('Could not submit. Try again.', false);
    }
  });

  // Initialize counters
  updateCounter();

} catch (err) {
  console.error("‚ùå Firebase setup failed in index.html:", err);
}
</script>
  <!-- ===== REVIEW MODAL (opens with ?review) ===== -->
  <div id="reviewOverlay" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); z-index:10000; align-items:flex-start; justify-content:center; overflow:auto;">
    <main aria-hidden="true" style="width:100%; display:flex; align-items:flex-start; justify-content:center; padding:8px 12px; box-sizing:border-box; min-height:100%;">
      <section class="card" role="dialog" aria-modal="true" aria-labelledby="review-title" style="width:clamp(320px, 92vw, 560px); max-height:90vh; overflow:auto; background:#0f1320; color:#e6edf3; border:1px solid #1e2432; border-radius:8px; box-shadow:0 18px 50px rgba(0,0,0,0.55); position:relative; margin:100px auto;">
        <style>
          #reviewOverlay h1, #reviewOverlay h2, #reviewOverlay h3, #reviewOverlay p { margin-top: 0; margin-bottom: 10px; }
        </style>
        <div class="card-header" style="padding:10px 14px; border-bottom:1px solid #1e2432;">
            <h1 id="review-title" class="title" style="margin:0; font-size:24px; line-height:1.2; font-weight:800; letter-spacing:0.2px; text-align: center; margin: 15px;">Leave a Review</h1>
          <button id="reviewCloseBtn" type="button" aria-label="Close" style="position:absolute; right:16px; top:16px; cursor:pointer; color:#9aa7bd; font-size:20px; background:none; border:none;">&times;</button>
        </div>

        <form id="reviewForm" class="form" aria-describedby="review-help" style="padding:20px 22px 22px; display:flex; flex-direction:column; gap:16px;">
          <div style="display:flex; flex-direction:column; gap:8px;">
            <label for="reviewName" style="font-weight:600; font-size:14px;">Name (can be a nickname)</label>
            <input id="reviewName" name="name" type="text" placeholder="Your display name" autocomplete="name" required style="width:100%; box-sizing:border-box; padding:12px 14px; background:#0b1020; color:#e6edf3; border:1px solid #232a3a; border-radius:6px; outline:none; font-size:14px;" />
          </div>

          <div style="display:flex; flex-direction:column; gap:8px;">
            <label style="font-weight:600; font-size:14px;">Rating</label>
            <div class="stars" role="radiogroup" aria-label="Star rating" style="display:flex; gap:8px; align-items:center;">
              <input type="radio" id="reviewStar1" name="reviewStars" value="1" required style="display:none;" />
              <label for="reviewStar1" title="1 star" aria-label="1 star" data-star="1" style="cursor:pointer; font-size:26px; line-height:1; user-select:none; padding:6px 8px; border:1px solid #232a3a; border-radius:6px; color:#9aa7bd;">‚òÖ</label>
              <input type="radio" id="reviewStar2" name="reviewStars" value="2" style="display:none;" />
              <label for="reviewStar2" title="2 stars" aria-label="2 stars" data-star="2" style="cursor:pointer; font-size:26px; line-height:1; user-select:none; padding:6px 8px; border:1px solid #232a3a; border-radius:6px; color:#9aa7bd;">‚òÖ</label>
              <input type="radio" id="reviewStar3" name="reviewStars" value="3" style="display:none;" />
              <label for="reviewStar3" title="3 stars" aria-label="3 stars" data-star="3" style="cursor:pointer; font-size:26px; line-height:1; user-select:none; padding:6px 8px; border:1px solid #232a3a; border-radius:6px; color:#9aa7bd;">‚òÖ</label>
              <input type="radio" id="reviewStar4" name="reviewStars" value="4" style="display:none;" />
              <label for="reviewStar4" title="4 stars" aria-label="4 stars" data-star="4" style="cursor:pointer; font-size:26px; line-height:1; user-select:none; padding:6px 8px; border:1px solid #232a3a; border-radius:6px; color:#9aa7bd;">‚òÖ</label>
              <input type="radio" id="reviewStar5" name="reviewStars" value="5" style="display:none;" />
              <label for="reviewStar5" title="5 stars" aria-label="5 stars" data-star="5" style="cursor:pointer; font-size:26px; line-height:1; user-select:none; padding:6px 8px; border:1px solid #232a3a; border-radius:6px; color:#9aa7bd;">‚òÖ</label>
            </div>
            <p class="help" id="review-help" style="margin:0; font-size:12px; color:#9aa7bd;">Rate the puzzle you took</p>
          </div>

          <div style="display:flex; flex-direction:column; gap:8px;">
            <label for="reviewText" style="font-weight:600; font-size:14px;">Your Review</label>
            <textarea id="reviewText" name="text" placeholder="Please include which puzzle you did, and what you liked/disliked about it." required minlength="50" maxlength="250" style="width:100%; min-height:120px; box-sizing:border-box; padding:12px 14px; background:#0b1020; color:#e6edf3; border:1px solid #232a3a; border-radius:6px; resize:vertical; outline:none; font-size:14px;"></textarea>
          </div>
          <div id="charRow" style="display:flex; justify-content:space-between; align-items:center; margin-top:6px; font-size:12px; color:#9aa7bd;">
            <span id="charMsg" aria-live="polite">Please write some more.</span>
            <span id="charCount" aria-live="polite">0/250</span>
          </div>

          <div class="actions" style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
            <button type="submit" id="reviewSubmitBtn" style="appearance:none; border:none; background:#e63946; color:white; font-weight:700; padding:12px 16px; border-radius:6px; cursor:pointer; box-shadow:0 4px 10px rgba(0,0,0,0.25);">Submit Review</button>
          </div>
        </form>
      </section>
      <div id="reviewToast" aria-live="polite" style="position:fixed; left:50%; bottom:28px; transform:translateX(-50%); display:none; background:#111828; color:#e6edf3; border:1px solid #1e2432; border-radius:8px; padding:10px 14px; box-shadow:0 12px 30px rgba(0,0,0,0.4); font-size:14px; z-index:10001;">üëç Done</div>
    </main>
  </div>
</body>
  <style>
  .faq-item {
    margin: 1rem 0;
  }

  .faq-question {
    background-color: #1a1a2a;
    color: white;
    padding: 12px 16px;
    border: none;
    width: 100%;
    text-align: left;
    font-size: 1rem;
    cursor: pointer;
    border-radius: 8px;
    font-weight: bold;
    transition: background-color 0.3s;
  }

  .faq-answer {
    display: none;
    padding: 10px 16px;
    background: #1a1a1a;
    color: white;
    border-radius: 0 0 8px 8px;
    font-size: 0.95rem;
  }

  .faq-question.active + .faq-answer {
    display: block;
  }
  </style>

  <script>
    document.querySelectorAll('.faq-question').forEach(button => {
      button.addEventListener('click', () => {
        button.classList.toggle('active');
        const answer = button.nextElementSibling;
        answer.style.display = answer.style.display === 'block' ? 'none' : 'block';
      });
    });
  </script>
</html>